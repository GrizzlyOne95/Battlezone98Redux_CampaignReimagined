<!DOCTYPE html>
<!-- saved from url=(0065)https://www.videoventure.org/battlezone/lua_script_utilities.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Battlezone Lua Script Utility Functions</title>
<link rel="stylesheet" type="text/css" href="./Battlezone Lua Script Utility Functions_files/battlezone.css">
</head>
<body>

<h1>Battlezone Lua Script Utility Functions</h1>
<p>Document Revised 2018-04-15</p>
<p>Covers <em>Battlezone</em> up to version 1.5.2.27u1</p>
<p>Covers <em>Battlezone 98 Redux</em> versions 2.1+</p>

<p>This document describes the global script utility functions available for user-created Lua mission scripts. They offer the same functionality that the original designers used when creating the single-player campaign, along with new functionality back-ported from 
<em>Battlezone II: Combat Commander</em> or added to fill notable gaps.</p>

<p>Version numbers appearing in [square brackets] indicate the earliest version that supports the value or function. While a script could check the version number, it's faster and easier to check if the value or function is nil.</p>

<h2 id="CategoryGlobals">Globals</h2>
<p>The Lua scripting system defines some global variables that can be of use to user scripts.</p>

<h3 id="GameVersion">string GameVersion</h3>
<p>Contains current build version (e.g. "1.5.2.27u1").</p>
<p><em>Battlezone 1.5</em> versions start with "1" and <em>Battlezone 98 Redux</em> versions start with "2".</p>

<h3 id="Language">integer Language [2.0+]</h3>
<p>Contains the index of the current language.</p>
<ol>
    <li>English</li>
    <li>French</li>
    <li>German</li>
    <li>Spanish</li>
    <li>Italian</li>
    <li>Portuguese</li>
    <li>Russian</li>
</ol>

<h3 id="LanguageName">string LanguageName [2.0+]</h3>
<p>Contains the full name of the current language in all-caps:<br>
"ENGLISH", "FRENCH", "GERMAN", "SPANISH", "ITALIAN", "PORTUGUESE", or "RUSSIAN"</p>

<h3 id="LanguageSuffix">string LanguageSuffix [2.0+]</h3>
<p>Contains the two-letter language code of the current language:<br>
"en", "fr", "de", "es", "it", "pt" or "ru"</p>

<h3 id="LastGameKey">string LastGameKey</h3>
<p>Contains the most recently pressed game key (e.g. "Ctrl+Z")</p>

<h2 id="CategoryScriptEventHandlers">Script Event Handlers</h2>
<p>The Lua scripting system calls these script-defined functions when various script events occur. LuaMission looks up the functions by name so they can have different functions assigned to them at runtime.</p>

<h3 id="Load">Load ( ... )</h3>
<p>Called when loading state from a save game file, allowing the script to restore its state.</p>
<p>Data values returned from Save will be passed as parameters to Load in the same order they were returned. Load supports nil, boolean, handle, integer, number, string, vector, and matrix data types. It does not support function, thread, or arbitrary userdata types.</p>
<p>The console window will print the loaded values in human-readable format.</p>

<h3 id="Save">... Save ()</h3>
<p>Called when saving state to a save game file, allowing the script to preserve its state.</p>
<p>Any values returned by this function will be passed as parameters to Load when loading the save game file. Save supports nil, boolean, handle, integer, number, string, vector, and matrix data types. It does not support function, thread, or arbitrary userdata types.</p>
<p>The console window will print the saved values in human-readable format.</p>

<h3 id="Start">Start ()</h3>
<p>Called when the mission starts for the first time.</p>
<p>Use this function to perform any one-time script initialization.</p>

<h3 id="GameKey">GameKey ( string key )</h3>
<p>Called any time a game key is pressed.</p>
<p>Key is a string that consisting of zero or more modifiers (Ctrl, Shift, Alt) and a base key.</p>
<p>The base key for keys corresponding to a printable ASCII character is the upper-case version of that character.</p>
<p>The base key for other keys is the label on the keycap (e.g. PageUp, PageDown, Home, End, Backspace, and so forth).</p>

<h3 id="Update">Update ( number timestep )</h3>
<p>Called once per frame after updating the network system and before simulating game objects.</p>
<p>This function performs most of the mission script's game logic.</p>

<h3 id="CreateObject">CreateObject ( handle h )</h3>
<p>Called after any game object is created.</p>
<p>Handle is the game object that was created.</p>
<p>This function will get a lot of traffic so it should not do too much work.</p>

<h3 id="AddObject">AddObject ( handle h )</h3>
<p>Called when a game object gets added to the mission</p>
<p>Handle is the game object that was added</p>
<p>This function is normally called for "important" game objects, and excludes things like Scrap pieces.</p>

<h3 id="DeleteObject">DeleteObject ( handle h )</h3>
<p>Called before a game object is deleted.</p>
<p>Handle is the game object to be deleted.</p>
<p>This function will get a lot of traffic so it should not do too much work.</p>

<h3 id="CreatePlayer">CreatePlayer ( integer id, string name, integer team )</h3>
<p>Called when a player joins the session.</p>
<p>Players that join before the host launches trigger CreatePlayer just before the first Update.</p>
<p>Players that join joining after the host launches trigger CreatePlayer on entering the pre-game lobby.</p>
<p>This function gets called for the local player.</p>

<h3 id="AddPlayer">AddPlayer ( integer id, string name, integer team )</h3>
<p>Called when a player starts sending state updates.</p>
<p>This indicates that a player has finished loaded and started simulating.</p>
<p>This function is <i>not</i> called for the local player.</p>

<h3 id="DeletePlayer">DeletePlayer ( integer id, string name, integer team )</h3>
<p>Called when a player leaves the session.</p>

<h3 id="Receive">boolean Receive ( integer from, string type, ... )</h3>
<p>Called when a script-defined message arrives.</p>
<p>This function should return true if it handled the message and false, nil, or none if it did not.</p>
<p>From is the network player id of the sender.</p>
<p>Type is an arbitrary one-character string indicating the script-defined message type.</p>
<p>Data values passed as parameters to Send will arrive as parameters to Receive in the same order they were sent. Receive supports nil, boolean, handle, integer, number, string, vector, and matrix data types. It does not support function, thread, or arbitrary userdata types.</p>

<h3 id="Command">boolean Command ( string command, string arguments )</h3>
<p>Called for any in-game chat command that was not handled by the system, allowing script-defined commands.</p>
<p>This function should return true if it handled the command and false, nil, or none if it did not.</p>
<p>LuaMission breaks the command into </p>
<p>Command is the string immediately following the '/'. For example, the command for "/foo" is "foo".</p>
<p>Arguments arrive as a string parameter to Command. For example "/foo 1 2 3" would receive "1 2 3".</p>
<p>The Lua string library provides several functions that can split the string into separate items.</p>
<p>You can use string.match with captures if you have a specific argument list:</p>
<blockquote><pre>local foo, bar, baz = string.match(arguments, "(%g+) (%g+) (%g+)")</pre></blockquote>
<p>You can use string.gmatch, which returns an iterator, if you want to loop through arguments:</p>
<blockquote><pre>for arg in string.gmatch(arguments, "%g+") do ... end</pre></blockquote>
<p>Check the Lua <a href="http://lua-users.org/wiki/PatternsTutorial">patterns tutorial</a> and <a href="http://www.lua.org/manual/5.2/manual.html#6.4.1">patterns manual</a> for more details.</p>

<h2 id="CategoryAudioMessages">Audio Messages</h2>
<p>These functions control audio messages, 2D sounds typically used for radio messages, voiceovers, and narration.</p>
<p>Audio messages use the Voice Volume setting from the Audio Options menu.</p>

<h3 id="RepeatAudioMessage">RepeatAudioMessage ()</h3>
<p>Repeat the last audio message.</p>

<h3 id="AudioMessage">message AudioMessage ( string filename )</h3>
<p>Plays the given audio file, which must be an uncompressed RIFF WAVE (.WAV) file.</p>
<p>Returns an audio message handle.</p>

<h3 id="IsAudioMessageDone">boolean IsAudioMessageDone ( message msg )</h3>
<p>Returns true if the audio message has stopped. Returns false otherwise.</p>

<h3 id="StopAudioMessage">StopAudioMessage ( message msg )</h3>
<p>Stops the given audio message.</p>

<h3 id="IsAudioMessagePlaying">boolean IsAudioMessagePlaying ()</h3>
<p>Returns true if <em>any</em> audio message is playing. Returns false otherwise.</p>

<h2 id="CategorySoundEffects">Sound Effects</h2>
<p>These functions control sound effects, either positional 3D sounds attached 
to objects or global 2D sounds.</p>
<p>Sound effects use the Effects Volume setting from 
the Audio Options menu.</p>

<h3 id="StartSound">StartSound ( string filename, [ Handle h ], [ integer priority ], [ boolean 
loop ], [ integer volume ], [ integer rate ] )</h3>
<p>Plays the given audio file, which must be an uncompressed RIFF WAVE (.WAV) 
file.</p>
<p>Specifying an object handle creates a 
positional 3D sound that follows the object as it moves and stops 
automatically when the object goes away. Otherwise, the sound plays as a 
global 2D sound.</p>
<p>Priority ranges from 0 to 100, with higher priorities taking precedence 
over lower priorities when there are not enough channels. The default 
priority is 50 if not specified.</p>
<p>Looping sounds will play forever until explicitly stopped with 
StopSound or the object to which it is attached goes away. 
Non-looping sounds will play once and stop. The default is non-looping if 
not specified.</p>
<p>Volume ranges from 0 to 100, with 0 being silent and 100 being maximum 
volume. The default volume is 100 if not specified.</p>
<p>Rate overrides the playback rate of the sound file, so a value of 22050 would 
cause a sound file recorded at 11025 Hz to play back twice as fast. The 
rate defaults to the file's native rate if not specified.</p>

<h3 id="StopSound">StopSound ( string filename, [ Handle h ] )</h3>
<p>Stops the sound using the given filename and associated with the given 
object. Use a handle of none or nil to stop a global 2D sound.</p>

<h2 id="CategoryGameObject">Game Object</h2>
<p>These functions create, manipulate, and query game objects (vehicles, buildings, people, powerups, and scrap) and return or take as a parameter a game object handle.</p><p>
</p><p>Object handles are always safe to use, even if the game object itself is missing or destroyed.</p>

<h3 id="GetHandle">handle GetHandle ( string label )</h3>
<p>Returns the handle of the game object with the given label. Returns nil if none exists.</p>

<h3 id="BuildObjectAtHandle">handle BuildObject ( string odfname, integer teamnum, handle h )</h3>
<p>Creates a game object with the given odf name and team number at the location of a game object.</p>
<p>Returns the handle of the created object if it created one. Returns nil if it failed.</p>

<h3 id="BuildObjectAtPath">handle BuildObject ( string odfname, integer teamnum, string path, [ integer point ] )</h3>
<p>Creates a game object with the given odf name and team number at a point on the named path. It uses the start of the path if no point is given.</p>
<p>Returns the handle of the created object if it created one. Returns nil if it failed.</p>

<h3 id="BuildObjectAtVector">handle BuildObject ( string odfname, integer teamnum, vector position )</h3>
<p>Creates a game object with the given odf name and team number at the given position vector.</p>
<p>Returns the handle of the created object if it created one. Returns nil if it failed.</p>

<h3 id="BuildObjectAtMatrix">handle BuildObject ( string odfname, integer teamnum, matrix transform )</h3>
<p>Creates a game object with the given odf name and team number with the given transform matrix.</p>
<p>Returns the handle of the created object if it created one. Returns nil if it failed.</p>

<h3 id="RemoveObject">RemoveObject ( handle h )</h3>
<p>Removes the game object with the given handle.</p>

<h3 id="IsOdf">boolean IsOdf ( handle h, string odfname )</h3>
<p>Returns true if the game object's odf name matches the given odf name. Returns false otherwise.</p>

<h3 id="GetOdf">string GetOdf ( handle h )</h3>
<p>Returns the odf name of the game object. Returns nil if none exists.</p>

<h3 id="GetBase">string GetBase ( handle h )</h3>
<p>Returns the base config of the game object which determines what VDF/SDF model it uses. Returns nil if none exists.</p>

<h3 id="GetLabel">string GetLabel ( handle h )</h3>
<p>Returns the label of the game object (e.g. "avtank0_wingman"). Returns nil if none exists.</p>

<h3 id="SetLabel">SetLabel ( Handle h, string label )</h3>
<p>Set the label of the game object (e.g. "tank1").</p>
<p>Note: this function was misspelled as SettLabel in 1.5. It can be renamed compatibly
with a short snippet of code at the top of the mission script:</p>
<pre>SetLabel = SetLabel or SettLabel</pre>

<h3 id="GetClassSig">string GetClassSig ( handle h )</h3>
<p>Returns the four-character class signature of the game object (e.g. "WING"). Returns nil if none exists.</p>

<h3 id="GetClassLabel">string GetClassLabel ( handle h )</h3>
<p>Returns the class label of the game object (e.g. "wingman"). Returns nil if none exists.</p>

<h3 id="GetClassId">integer GetClassId ( handle h )</h3>
<p>Returns the numeric class identifier of the game object. Returns nil if none exists.</p>
<p>Looking up the class id number in the ClassId table will convert it to a string. Looking up the class id string in the ClassId table will convert it back to a number.</p>

<h3 id="ClassId">ClassId</h3>
<p>This is a global table that converts between class identifier numbers and class identifier names. For example, ClassId.SCRAP or ClassId["SCRAP"] returns the class identifier number (7) for the Scrap class; ClassId[7] returns the class identifier name ("SCRAP") for class identifier number 7. For maintainability, always use this table instead of raw class identifier numbers.</p>
<p>Available class identifiers: NONE, HELICOPTER, STRUCTURE1, POWERUP, PERSON, SIGN, VEHICLE, SCRAP, BRIDGE, FLOOR, STRUCTURE2, SCROUNGE, SPINNER, HEADLIGHT_MASK, EYEPOINT, COM, WEAPON, ORDNANCE, EXPLOSION, CHUNK, SORT_OBJECT, NONCOLLIDABLE, VEHICLE_GEOMETRY, STRUCTURE_GEOMETRY, WEAPON_GEOMETRY, ORDNANCE_GEOMETRY, TURRET_GEOMETRY, ROTOR_GEOMETRY, NACELLE_GEOMETRY, FIN_GEOMETRY, COCKPIT_GEOMETRY, WEAPON_HARDPOINT, CANNON_HARDPOINT, ROCKET_HARDPOINT, MORTAR_HARDPOINT, SPECIAL_HARDPOINT, FLAME_EMITTER, SMOKE_EMITTER, DUST_EMITTER, PARKING_LOT</p>

<h3 id="GetNation">string GetNation ( handle h )</h3>
<p>Returns the one-letter nation code of the game object (e.g. "a" for American, 
"b" for Black Dog, "c" for Chinese, and "s" for Soviet).</p>
<p>The nation code is usually 
but not always the same as the first letter of the odf name. The ODF file 
can override the nation in the [GameObjectClass] section, and player.odf is a 
hard-coded exception that uses "a" instead of "p".</p>
<h3>boolean IsValid ( handle h )</h3>
<p>Returns true if the game object exists. Returns false otherwise.</p>

<h3 id="IsAlive">boolean IsAlive ( handle h )</h3>
<p>Returns true if the game object exists and (if the object is a vehicle) controlled. Returns false otherwise.</p>

<h3 id="IsAliveAndPilot">boolean IsAliveAndPilot ( handle h )</h3>
<p>Returns true if the game object exists and (if the object is a vehicle) controlled and piloted. Returns false otherwise.</p>

<h3 id="IsCraft">boolean IsCraft ( handle h )</h3>
<p>Returns true if the game object exists and is a vehicle. Returns false otherwise.</p>

<h3 id="IsBuilding">boolean IsBuilding ( handle h )</h3>
<p>Returns true if the game object exists and is a building. Returns false otherwise.</p>

<h3 id="IsPerson">boolean IsPerson ( handle h )</h3>
<p>Returns true if the game object exists and is a person. Returns false otherwise.</p>

<h3 id="IsDamaged">boolean IsDamaged ( handle h [, float threshold] )</h3>
<p>Returns true if the game object exists and has less health than the threshold. Returns false otherwise.</p>

<h3 id="IsRecycledByTeam">boolean IsRecycledByTeam ( handle h, integer team ) [2.1+]</h3>
<p>Returns true if the game object was recycled by a Construction Rig on the given team.</p>

<h2 id="CategoryTeamNumber">Team Number</h2>
<p>These functions get and set team number. Team 0 is the neutral or environment team.</p>

<h3 id="GetTeamNum">integer GetTeamNum ( handle h )</h3>
<p>Returns the game object's team number.</p>

<h3 id="SetTeamNum">SetTeamNum ( handle h, integer team )</h3>
<p>Sets the game object's team number.</p>

<h3 id="GetPerceivedTeam">teamnum GetPerceivedTeam ( handle h, teamnum t )</h3>
<p>Returns the game object's perceived team number (as opposed to its real team number).</p>
<p>The perceived team will differ from the real team when a player enters an empty enemy vehicle without being seen until they attack something.</p>

<h3 id="SetPerceivedTeam">SetPerceivedTeam ( handle h, teamnum t )</h3>
<p>Set the game object's perceived team number (as opposed to its real team number).</p>
<p>Units on the game object's perceived team will treat it as friendly until it "blows its cover" by attacking, at which point it will revert to its real team.</p>
<p>Units on the game object's real team will treat it as friendly regardless of its perceived team.</p>

<h2 id="CategoryTarget">Target</h2>
<p>These function get and set a unit's target.</p>

<h3 id="SetUserTarget">SetUserTarget ( handle t )</h3>
<p>Sets the local player's target.</p>

<h3 id="GetUserTarget">handle GetUserTarget ()</h3>
<p>Returns the local player's target. Returns nil if it has none.</p>

<h3 id="SetTarget">SetTarget ( handle h, handle t )</h3>
<p>Sets the game object's target.</p>

<h3 id="GetTarget">handle GetTarget ( handle h )</h3>
<p>Returns the game object's target. Returns nil if it has none.</p>

<h2 id="CategoryOwner">Owner</h2>
<p>These functions get and set owner. The default owner for a game object is the game object that created it.</p>

<h3 id="SetOwner">SetOwner ( handle h, handle o )</h3>
<p>Sets the game object's owner.</p>

<h3 id="GetOwner">handle GetOwner ( handle h )</h3>
<p>Returns the game object's owner. Returns nil if it has none.</p>

<h2 id="CategoryPilotClass">Pilot Class</h2>
<p>These functions get and set vehicle pilot class.</p>

<h3 id="SetPilotClass">SetPilotClass ( handle h, string odfname )</h3>
<p>Sets the vehicle's pilot class to the given odf name. This does nothing useful for non-vehicle game objects. An odf name of nil resets the vehicle to the default assignment based on nation.</p>

<h3 id="GetPilotClass">string GetPilotClass ( handle h )</h3>
<p>Returns the odf name of the vehicle's pilot class. Returns nil if none exists.</p>

<h2 id="CategoryPositionAndOrientation">Position and Orientation</h2>
<p>These functions get and set position and orientation.</p>

<h3 id="SetPositionToPath">SetPosition ( handle h, string path, [ integer point ] )</h3>
<p>Teleports the game object to a point on the named path. It uses the start of the path if no point is given.</p>

<h3 id="SetPositionToVector">SetPosition ( handle h, vector position )</h3>
<p>Teleports the game object to the position vector.</p>

<h3 id="SetPositionToMatrix">SetPosition ( handle h, matrix transform )</h3>
<p>Teleports the game object to the position of the transform matrix.</p>

<h3 id="GetPosition">vector GetPosition ( handle h )</h3>
<p>Returns the game object's position vector. Returns nil if none exists.</p>

<h3 id="GetPositionOfPath">vector GetPosition ( string path, [ integer point ] )</h3>
<p>Returns the path point's position vector. Returns nil if none exists.</p>

<h3 id="GetFront">vector GetFront ( handle h )</h3>
<p>Returns the game object's front vector. Returns nil if none exists.</p>

<h3 id="SetTransform">SetTransform ( handle h, matrix transform )</h3>
<p>Teleports the game object to the given transform matrix.</p>

<h3 id="GetTransform">matrix GetTransform ( handle h )</h3>
<p>Returns the game object's transform matrix. Returns nil if none exists.</p>

<h2 id="CategoryLinearVelocity">Linear Velocity</h2>
<p>These functions get and set linear velocity.</p>

<h3 id="GetVelocity">vector GetVelocity ( handle h )</h3>
<p>Returns the game object's linear velocity vector. Returns nil if none exists.</p>

<h3 id="SetVelocity">SetVelocity ( handle h, vector velocity )</h3>
<p>Sets the game object's angular velocity vector. </p>

<h2 id="CategoryAngularVelocity">Angular Velocity</h2>
<p>These functions get and set angular velocity.</p>

<h3 id="GetOmega">vector GetOmega ( handle h )</h3>
<p>Returns the game object's angular velocity vector. Returns nil if none exists.</p>

<h3 id="SetOmega">SetOmega ( handle h, vector omega )</h3>
<p>Sets the game object's angular velocity vector.</p>

<h2 id="CategoryPositionHelpers">Position Helpers</h2>
<p>These functions help generate position values close to a center point.</p>

<h3 id="GetCircularPos">vector GetCircularPos ( vector center, [ number radius ], [ number angle ] )</h3>
<p>Returns a ground position offset from the center by the radius in a direction controlled by the angle.</p>
<p>If no radius is given, it uses a default radius of zero.</p>
<p>If no angle is given, it uses a default angle of zero.</p>
<p>An angle of zero is +X (due east), pi * 0.5 is +Z (due north), pi is -X (due west), and pi * 1.5 is -Z (due south).</p>

<h3 id="GetPositionnear">vector GetPositionNear ( vector center, [ number minradius ], [ number maxradius ] )</h3>
<p>Returns a ground position in a ring around the center between minradius and maxradius with roughly the same terrain height as the terrain height at the center.</p>
<p>This is good for scattering spawn positions around a point while excluding positions that are too high or too low.</p>
<p>If no radius is given, it uses the default radius of zero.</p>

<h2 id="CategoryShot">Shot</h2>
<p>These functions query a game object for information about ordnance hits.</p>

<h3 id="GetWhoShotMe">handle GetWhoShotMe ( handle h )</h3>
<p>Returns who scored the most recent hit on the game object. Returns nil if none exists.</p>

<h3 id="GetLastEnemyShot">float GetLastEnemyShot ( handle h )</h3>
<p>Returns the last time an enemy shot the game object.</p>

<h3 id="GetLastFriendShot">float GetLastFriendShot ( handle h )</h3>
<p>Returns the last time a friend shot the game object.</p>

<h2 id="CategoryAlliances">Alliances</h2>
<p>These functions control and query alliances between teams.</p>
<p>The team manager assigns each player a separate team number, starting with 1 and going as high as 15. Team 0 is the neutral "environment" team.</p>
<p>Unless specifically overridden, every team is friendly with itself, neutral with team 0, and hostile to everyone else.</p>

<h3 id="DefaultAllies">DefaultAllies ()</h3>
<p>Sets team alliances back to default.</p>

<h3 id="LockAllies">LockAllies ( boolean lock )</h3>
<p>Sets whether team alliances are locked. Locking alliances prevents players from allying or un-allying, preserving alliances set up by the mission script.</p>

<h3 id="Ally">Ally ( integer team1, integer team2 )</h3>
<p>Makes the two teams allies of each other.</p>
<p>This function affects both teams so Ally(1, 2) and Ally(2, 1) produces the identical results, unlike the "half-allied" state created by the "ally" game key.</p>

<h3 id="UnAlly">UnAlly ( integer team1, integer team2 )</h3>
<p>Makes the two teams enemies of each other.</p>
<p>This function affects both teams so UnAlly(1, 2) and UnAlly(2, 1) produces the identical results, unlike the "half-enemy" state created by the "unally" game key.</p>

<h3 id="IsTeamAllied">boolean IsTeamAllied ( integer team1, integer team2 )</h3>
<p>Returns true if team1 considers team2 an ally. Returns false otherwise.</p>
<p>Due to the possibility of player-initiated "half-alliances", IsTeamAllied(team1, team2) might not return the same result as IsTeamAllied(team2, team1).</p>

<h3 id="IsAlly">boolean IsAlly ( handle me, handle him )</h3>
<p>Returns true if game object "me" considers game object "him" an ally. Returns false otherwise.</p>
<p>Due to the possibility of player-initiated "half-alliances", IsAlly(me, him) might not return the same result as IsAlly(him, me).</p>

<h2 id="CategoryObjectiveMarker">Objective Marker</h2>
<p>These functions control objective markers.</p>
<p>Objectives are visible to all teams from any distance and from any direction, with an arrow pointing to off-screen objectives. There is currently no way to make team-specific objectives.</p>

<h3 id="SetObjectiveOn">SetObjectiveOn ( handle h )</h3>
<p>Sets the game object as an objective to all teams.</p>

<h3 id="SetObjectiveOff">SetObjectiveOff ( handle h )</h3>
<p>Sets the game object back to normal.</p>

<h3 id="GetObjectiveName">string GetObjectiveName ( handle h )</h3>
<p>Gets the game object's visible name.</p>

<h3 id="SetObjectiveName">SetObjectiveName ( handle h, string name )</h3>
<p>Sets the game object's visible name.</p>

<h3 id="SetName">SetName ( handle h, string name ) [2.1+]</h3>
<p>Sets the game object's visible name. This function is effectively an alias for SetObjectiveName.</p>

<h2 id="CategoryDistance">Distance</h2>
<p>These functions measure and return the distance between a game object and a reference point.</p>

<h3 id="GetDistanceToHandle">number GetDistance ( handle h1, handle h2 )</h3>
<p>Returns the distance in meters between the two game objects.</p>

<h3 id="GetDistanceToPath">number GetDistance ( handle h1, string path, [ integer point ] )</h3>
<p>Returns the distance in meters between the game object and a point on the path. It uses the start of the path if no point is given.</p>

<h3 id="GetDistanceToVector">number GetDistance ( handle h1, vector position )</h3>
<p>Returns the distance in meters between the game object and a position vector.</p>

<h3 id="GetDistanceToMatrix">number GetDistance ( handle h1, matrix transform )</h3>
<p>Returns the distance in meters between the game object and the position of a transform matrix.</p>

<h3 id="IsWithin">boolean IsWithin ( handle h1, handle h2, number dist )</h3>
<p>Returns true if the units are closer than the given distance of each other. Returns false otherwise.</p>
<p> (This function is equivalent to GetDistance (h1, h2) &lt; d)</p>

<h3 id="IsTouching">bool IsTouching( handle h1, handle h2, [ number tolerance ] ) [2.1+]</h3>
<p>Returns true if the bounding spheres of the two game objects are within the specified tolerance. The default tolerance is 1.3 meters if not specified.</p>

<h2 id="CategoryNearest">Nearest</h2>
<p>These functions find and return the game object of the requested type closest to a reference point.</p>

<h3 id="GetNearestObjectToHandle">handle GetNearestObject ( handle h )</h3>
<p>Returns the game object closest to the given game object. Returns nil if none exists.</p>

<h3 id="GetNearestObjectToPath">handle GetNearestObject ( string path, [ integer point ] )</h3>
<p>Returns the game object closest to a point on the path. It uses the start of the path if no point is given. Returns nil if none exists.</p>

<h3 id="GetNearestObjectToVector">handle GetNearestObject ( vector position )</h3>
<p>Returns the game object closest to the position vector. Returns nil if none exists.</p>

<h3 id="GetNearestObjectToMatrix">handle GetNearestObject ( matrix transform )</h3>
<p>Returns the game object closest to the position of the transform matrix. Returns nil if none exists.</p>

<h3 id="GetNearestVehicleToHandle">handle GetNearestVehicle ( handle h )</h3>
<p>Returns the craft closest to the given game object. Returns nil if none exists.</p>

<h3 id="GetNearestVehicleToPath">handle GetNearestVehicle ( string path, [ integer point ] )</h3>
<p>Returns the craft closest to a point on the path. It uses the start of the path if no point is given. Returns nil if none exists.</p>

<h3 id="GetNearestVehicleToVector">handle GetNearestVehicle ( vector position )</h3>
<p>Returns the vehicle closest to the position vector. Returns nil if none exists.</p>

<h3 id="GetNearestVehicleToMatrix">handle GetNearestVehicle ( matrix transform )</h3>
<p>Returns the vehicle closest to the position of the transform matrix. Returns nil if none exists.</p>

<h3 id="GetNearestBuildingToHandle">handle GetNearestBuilding ( handle h )</h3>
<p>Returns the building closest to the given game object. Returns nil if none exists.</p>

<h3 id="GetNearestBuildingToPath">handle GetNearestBuilding ( string path, [ integer point ] )</h3>
<p>Returns the building closest to a point on the path. It uses the start of the path if no point is given. Returns nil if none exists.</p>

<h3 id="GetNearestBuildingToVector">handle GetNearestBuilding ( vector position )</h3>
<p>Returns the building closest to the position vector. Returns nil if none exists.</p>

<h3 id="GetNearestBuildingToMatrix">handle GetNearestBuilding ( matrix transform )</h3>
<p>Returns the building closest to the position of the transform matrix. Returns nil if none exists.</p>

<h3 id="GetNearestEnemyToHandle">handle GetNearestEnemy ( handle h )</h3>
<p>Returns the enemy closest to the given game object. Returns nil if none exists.</p>

<h3 id="GetNearestEnemyToPath">handle GetNearestEnemy ( string path, [ integer point ] )</h3>
<p>Returns the enemy closest to a point on the path. It uses the start of the path if no point is given. Returns nil if none exists.</p>

<h3 id="GetNearestEnemyToVector">handle GetNearestEnemy ( vector position )</h3>
<p>Returns the enemy closest to the position vector. Returns nil if none exists.</p>

<h3 id="GetNearestEnemyToMatrix">handle GetNearestEnemy ( matrix transform )</h3>
<p>Returns the enemy closest to the position of the transform matrix. Returns nil if none exists.</p>

<h3 id="GetNearestFriendToHandle">handle GetNearestFriend ( handle h ) [2.0+]</h3>
<p>Returns the friend closest to the given game object. Returns nil if none exists.</p>

<h3 id="GetNearestFriendToPath">handle GetNearestFriend ( string path, [ integer point ] ) [2.0+]</h3>
<p>Returns the friend closest to a point on the path. It uses the start of the path if no point is given. Returns nil if none exists.</p>

<h3 id="GetNearestFriendToVector">handle GetNearestFriend ( vector position ) [2.0+]</h3>
<p>Returns the friend closest to the position vector. Returns nil if none exists.</p>

<h3 id="GetNearestFriendToMatrix">handle GetNearestFriend ( matrix transform ) [2.0+]</h3>
<p>Returns the friend closest to the position of the transform matrix. Returns nil if none exists.</p>

<h3 id="GetNearestUnitOnTeamToHandle">handle GetNearestUnitOnTeam ( handle h, int team ) [2.1+]</h3>
<p>Returns the craft or person on the given team closest to the given game object. Returns nil if none exists.</p>

<h3 id="GetNearestUnitOnTeamToPath">handle GetNearestUnitOnTeam ( string path, [ integer point ], int team ) [2.1+]</h3>
<p>Returns the craft or person on the given team closest to a point on the path. It uses the start of the path if no point is given. Returns nil if none exists.</p>

<h3 id="GetNearestUnitOnTeamToVector">handle GetNearestUnitOnTeam ( vector position, int team ) [2.1+]</h3>
<p>Returns the craft or person on the given team closest to the position of the transform matrix. Returns nil if none exists.</p>

<h3 id="GetNearestUnitOnTeamToMatrix">handle GetNearestUnitOnTeam ( matrix transform, int team ) [2.1+]</h3>
<p>Returns the craft or person on the given team closest to the position vector. Returns nil if none exists.</p>

<h3 id="CountUnitsNearObject">integer CountUnitsNearObject ( handle h, number dist, integer team, string odfname )</h3>
<p>Returns how many objects with the given team and odf name are closer than the given distance.</p>

<h2 id="CategoryIterators">Iterators</h2>
<p>These functions return iterator functions for use with Lua's "for &lt;variable&gt; in &lt;expression&gt; do ... end" form. For example: "for h in AllCraft() do print(h, GetLabel(h)) end" will print the game object handle and label of every craft in the world.</p>

<h3 id="ObjectsInRangeOfHandle">iterator ObjectsInRange ( number dist, handle h )</h3>
<p>Enumerates game objects within the given distance of the game object.</p>

<h3 id="ObjectsInRangeOfPath">iterator ObjectsInRange ( number dist, name path, [ integer point ] )</h3>
<p>Enumerates game objects within the given distance of the path point. It uses the start of the path if no point is given.</p>

<h3 id="ObjectsInRangeOfVector">iterator ObjectsInRange ( number dist, vector position )</h3>
<p>Enumerates game objects within the given distance of the position vector.</p>

<h3 id="ObjectsInRangeOfMatrix">iterator ObjectsInRange ( number dist, matrix transform )</h3>
<p>Enumerates game objects within the given distance of the transform matrix.</p>

<h3 id="AllObjects">iterator AllObjects ()</h3>
<p>Enumerates all game objects.</p>
<p>Use this function sparingly at runtime since it enumerates <em>all</em> game objects, including every last piece of scrap. If you're specifically looking for craft, use AllCraft() instead.</p>

<h3 id="AllCraft">iterator AllCraft ()</h3>
<p>Enumerates all craft.</p>

<h3 id="SelectedObjects">iterator SelectedObjects ()</h3>
<p>Enumerates all game objects currently selected by the local player.</p> 

<h3 id="ObjectiveObjects">iterator ObjectiveObjects ()</h3>
<p>Enumerates all game objects marked as objectives.</p>

<h2 id="CategoryScrapManagement">Scrap Management</h2>
<p>These functions remove scrap, either to reduce the global game object count 
or to remove clutter around a location.</p>

<h3 id="GetRidOfSomeScrap">GetRidOfSomeScrap ( [ integer limit ] )</h3>
<p>While the global scrap count is above the limit, remove the oldest scrap piece. It no limit is given, it uses the default limit of 300.</p>

<h3 id="ClearScrapAroundHandle">ClearScrapAround ( number distance, handle h )</h3>
<p>Clear all scrap within the given distance of a game object.</p>

<h3 id="ClearScrapAroundPath">ClearScrapAround ( number distance, string path, [ integer point ] )</h3>
<p>Clear all scrap within the given distance of a point on the path. It uses the start of the path if no point is given.</p>

<h3 id="ClearScrapAroundVector">ClearScrapAround ( number distance, vector position )</h3>
<p>Clear all scrap within the given distance of a position vector.</p>

<h3 id="ClearScrapAroundMatrix">ClearScrapAround ( number distance, matrix transform )</h3>
<p>Clear all scrap within the given distance of the position of a transform matrix.</p>

<h2 id="CategoryTeamSlots">Team Slots</h2>
<p>These functions look up game objects in team slots.</p>

<h3 id="TeamSlot">TeamSlot</h3>
<p>This is a global table that converts between team slot numbers and team slot names. For example, 
TeamSlot.PLAYER or TeamSlot["PLAYER"] returns the team slot (0) for the player; 
TeamSlot[0] returns the team slot name ("PLAYER") for team slot 0. For maintainability, always use this table instead of raw 
team slot numbers.</p>

<p>Available slots: UNDEFINED, PLAYER, RECYCLER, FACTORY, ARMORY, CONSTRUCT,
MIN_OFFENSE, MAX_OFFENSE, MIN_DEFENSE, MAX_DEFENSE, MIN_UTILITY, MAX_UTILITY,
MIN_BEACON, MAX_BEACON, MIN_POWER, MAX_POWER, MIN_COMM, MAX_COMM,
 MIN_REPAIR, MAX_REPAIR, MIN_SUPPLY, MAX_SUPPLY, MIN_SILO, MAX_SILO,
MIN_BARRACKS, MAX_BARRACKS, MIN_GUNTOWER, MAX_GUNTOWER.</p>

<p>Slots starting with MIN_ and MAX_ represent the lower and upper bound of a range of slots.</p>

<h3 id="GetTeamSlot">handle GetTeamSlot ( integer slot, [ integer team ] )</h3>
<p>Get the game object in the specified team slot.</p>
<p>It uses the local player team if no team is given.</p>

<h3 id="GetPlayerHandle">handle GetPlayerHandle ( [ integer team ])</h3>
<p>Returns the game object controlled by the player on the given team. Returns nil if none exists.</p>
<p>It uses the local player team if no team is given.</p>

<h3 id="GetRecyclerHandle">handle GetRecyclerHandle ( [ integer team ] )</h3>
<p>Returns the Recycler on the given team. Returns nil if none exists.</p>
<p>It uses the local player team if no team is given.</p>

<h3 id="GetFactoryHandle">handle GetFactoryHandle ( [ integer team ] )</h3>
<p>Returns the Factory on the given team. Returns nil if none exists.</p>
<p>It uses the local player team if no team is given.</p>

<h3 id="GetArmoryHandle">handle GetArmoryHandle ( [ integer team ] )</h3>
<p>Returns the Armory on the given team. Returns nil if none exists.</p>
<p>It uses the local player team if no team is given.</p>

<h3 id="GetConstructorHandle">handle GetConstructorHandle ( [ integer team ] )</h3>
<p>Returns the Constructor on the given team. Returns nil if none exists.</p>
<p>It uses the local player team if no team is given.</p>

<h2 id="CategoryTeamPilots">Team Pilots</h2>
<p>These functions get and set pilot counts for a team.</p>

<h3 id="AddPilot">integer AddPilot ( integer team, integer count )</h3>
<p>Adds pilots to the team's pilot count, clamped between zero and maximum count.</p>
<p>Returns the new pilot count.</p>

<h3 id="SetPilot">integer SetPilot ( integer team, integer count )</h3>
<p>Sets the team's pilot count, clamped between zero and maximum count.</p>
<p>Returns the new pilot count.</p>

<h3 id="GetPilot">integer GetPilot ( integer team )</h3>
<p>Returns the team's pilot count.</p>

<h3 id="AddMaxPilot">integer AddMaxPilot ( integer team, integer count )</h3>
<p>Adds pilots to the team's maximum pilot count.</p>
<p>Returns the new pilot count.</p>

<h3 id="SetMaxPilot">integer SetMaxPilot ( integer team, integer count )</h3>
<p>Sets the team's maximum pilot count.</p>
<p>Returns the new pilot count.</p>

<h3 id="GetMaxPilot">integer GetMaxPilot ( integer team )</h3>
<p>Returns the team's maximum pilot count.</p>

<h2 id="CategoryTeamScrap">Team Scrap</h2>
<p>These functions get and set scrap values for a team.</p>

<h3 id="AddScrap">integer AddScrap ( integer team, integer count )</h3>
<p>Adds to the team's scrap count, clamped between zero and maximum count.</p>
<p>Returns the new scrap count.</p>

<h3 id="SetScrap">integer SetScrap ( integer team, integer count )</h3>
<p>Sets the team's scrap count, clamped between zero and maximum count.</p>
<p>Returns the new scrap count.</p>

<h3 id="GetScrap">integer GetScrap ( integer team )</h3>
<p>Returns the team's scrap count.</p>

<h3 id="AddMaxScrap">integer AddMaxScrap ( integer team, integer count )</h3>
<p>Adds to the team's maximum scrap count.</p>
<p>Returns the new maximum scrap count.</p>

<h3 id="SetMaxScrap">integer SetMaxScrap ( integer team, integer count )</h3>
<p>Sets the team's maximum scrap count.</p>
<p>Returns the new maximum scrap count.</p>

<h3 id="GetMaxScrap">integer GetMaxScrap ( integer team )</h3>
<p>Returns the team's maximum scrap count.</p>

<h2 id="CategoryDeploy">Deploy</h2>
<p>These functions control deployable craft (such as Turret Tanks or Producer units).</p>

<h3 id="IsDeployed">boolean IsDeployed ( handle h )</h3>
<p>Returns true if the game object is a deployed craft. Returns false otherwise.</p>

<h3 id="Deploy">Deploy ( handle h )</h3>
<p>Tells the game object to deploy.</p>

<h2 id="CategorySelection">Selection</h2>
<p>These functions access selection state (i.e. whether the player has selected a game object)</p>

<h3 id="IsSelected">boolean IsSelected ( handle h )</h3>
<p>Returns true if the game object is selected. Returns false otherwise.</p>

<h2 id="CategoryMissionCritical">Mission-Critical [2.0+]</h2>
<p>The "mission critical" property indicates that a game object is vital to the success of the mission and disables the "Pick Me Up" and "Recycle" commands that (eventually) cause IsAlive() to report false.</p>

<h3 id="IsCritical">boolean IsCritical ( handle h ) [2.0+]</h3>
<p>Returns true if the game object is marked as mission-critical. Returns false otherwise.</p>

<h3 id="SetCritical">SetCritical ( handle h , [ bool critical ] ) [2.0+]</h3>
<p>Sets the game object's mission-critical status.</p>
<p>If critical is true or not specified, the object is marked as mission-critical. Otherwise, the object is marked as not mission critical.</p>

<h2 id="CategoryWeapon">Weapon</h2>
<p>These functions access unit weapons and damage.</p>

<h3 id="SetWeaponMask">SetWeaponMask ( handle h, integer mask )</h3>
<p>Sets what weapons the unit's AI process will use.</p>
<p>To calculate the mask value, add up the values of the weapon hardpoint slots you want to enable.</p>
<p>weaponHard1: 1 weaponHard2: 2 weaponHard3: 4 weaponHard4: 8 weaponHard5: 16</p>

<h3 id="GiveWeapon">GiveWeapon ( handle h, [ string weaponname ], [ integer slot ] )</h3>
<p>Gives the game object the named weapon in the given slot. If no slot is given, it chooses a slot based on hardpoint type and weapon priority like a weapon powerup would. If the weapon name is empty, nil, or blank and a slot is given, it removes the weapon in that slot.</p>
<p>Returns true if it succeeded. Returns false otherwise.</p>

<h3 id="GetWeaponClass">string GetWeaponClass ( handle h, integer slot )</h3>
<p>Returns the odf name of the weapon in the given slot on the game object. 
Returns nil if the game object does not exist or the slot is empty.</p>
<p>For example, an "avtank" game object would return "gatstab" for index 0 and 
"gminigun" for index 1.</p>

<h3 id="FireAt">FireAt ( handle me, handle him )</h3>
<p>Tells the game object to fire at the given target.</p>

<h3 id="Damage">Damage ( handle h, number amount )</h3>
<p>Applies damage to the game object.</p>

<h2 id="CategoryTime">Time</h2>
<p>These function report various global time values.</p>

<h3 id="GetTime">number GetTime ()</h3>
<p>Returns the elapsed time in seconds since the start of the mission.</p>

<h3 id="GetTimeStep">number GetTimeStep ()</h3>
<p>Returns the simulation time step in seconds.</p>

<h3 id="GetTimeNow">number GetTimeNow ()</h3>
<p>Returns the current system time in milliseconds. This is mostly useful for performance profiling.</p>

<h2 id="CategoryMission">Mission</h2>
<p>These functions control general mission properties like strategic AI and mission flow</p>

<h3 id="SetAIControl">SetAIControl ( integer team, [ boolean control ] )</h3>
<p>Enables (or disables) strategic AI control for a given team. As of version 1.5.2.7, mission scripts must enable AI control for any team that intends to use an AIP.</p>
<p>IMPORTANT SAFETY TIP: only call this function from the "root" of the Lua mission script! The strategic AI gets set up shortly afterward and attempting to use SetAIControl later will crash the game.</p>

<h3 id="GetAIControl">boolean GetAIControl ( integer team )</h3>
<p>Returns true if a given team is AI controlled. Returns false otherwise.</p>
<p>Unlike SetAIControl, this function may be called at any time.</p>

<h3 id="GetAIP">string GetAIP ( [ integer team ] ) </h3>
<p>Returns the current AIP for the team. It uses team 2 if no team number is given.</p>

<h3 id="SetAIP">SetAIP ( string aipname, [ integer team ] )</h3>
<p>Switches the team's AI plan. It uses team 2 if no team number is given.</p>

<h3 id="FailMission">FailMission ( number time, [ string filename ] )</h3>
<p>Fails the mission after the given time elapses. If supplied with a filename (usually a .des), it sets the failure message to text from that file.</p>

<h3 id="SucceedMission">SucceedMission ( number time, [ string filename ] )</h3>
<p>Succeeds the mission after the given time elapses. If supplied with a filename (usually a .des), it sets the success message to text from that file.</p>

<h2 id="CategoryObjectiveMessages">Objective Messages</h2>
<p>These functions control the objective panel visible at the right of the 
screen.</p>

<h3 id="ClearObjectives">ClearObjectives ()</h3>
<p>Clears all objective messages.</p>

<h3 id="AddObjective">AddObjective ( string name, [ string color ], [ number duration ], [ string text ] )</h3>
<p>Adds an objective message with the given name and properties.</p>
<p>The message defaults to white if no color is given. The color may be "black", "dkgrey", "grey", "white", "blue", "dkblue", "green", "dkgreen", "yellow", "dkyellow", "red", or "dkred"; the value is case-insensitive.</p>
<p>The message lasts 8 seconds if no duration is given.</p>
<p>The message text defaults to the contents of of the file with the specified name (usually an .otf).</p>
<p>Script-supplied message text is only available in version 2.0.121.1 or higher.</p>

<h3 id="UpdateObjective">UpdateObjective ( string name, [ string color ], [ number duration ], [ string text ] )</h3>
<p>Updates the objective message with the given name. If no objective exists with that name, it does nothing.</p>
<p>The message defaults to white if no color is given. The color may be "black", "dkgrey", "grey", "white", "blue", "dkblue", "green", "dkgreen", "yellow", "dkyellow", "red", or "dkred"; the value is case-insensitive.</p>
<p>The message lasts 8 seconds if no duration is given.</p>
<p>The message text will keep its previous value if no text is given.</p>
<p>Script-supplied message text is only available in version 2.0.121.1 or higher.</p>

<h3 id="RemoveObjective">RemoveObjective ( string name )</h3>
<p>Removes the objective message with the given file name. Messages after the removed message will be moved up to fill the vacancy. If no objective exists with that file name, it does nothing.</p>

<h2 id="CategoryCockpitTimer">Cockpit Timer</h2>
<p>These functions control the large timer at the top of the screen.</p>

<h3 id="StartCockpitTimer">StartCockpitTimer ( integer time, [ integer warn ], [ integer alert ] )</h3>
<p>Starts the cockpit timer counting down from the given time. If a warn time is given, the timer will turn yellow when it reaches that value. If an alert time is given, the timer will turn red when it reaches that value. All time values are in seconds.</p>
<p>The start time can be up to 35999, which will appear on-screen as 9:59:59. 
If the remaining time is an hour or less, the timer will show only minutes and 
seconds.</p>

<h3 id="StartCockpitTimerUp">StartCockpitTimerUp ( integer time, [ integer warn ], [ integer alert ] )</h3>
<p>Starts the cockpit timer counting up from the given time. If a warn time is given, the timer will turn yellow when it reaches that value. If an alert time is given, the timer will turn red when it reaches that value. All time values are in seconds.</p>
<p>The on-screen timer will always show hours, minutes, and seconds The 
hours digit will malfunction after 10 hours.</p>

<h3 id="StopCockpitTimer">StopCockpitTimer ()</h3>
<p>Stops the cockpit timer.</p>

<h3 id="HideCockpitTimer">HideCockpitTimer ()</h3>
<p>Hides the cockpit timer.</p>

<h3 id="GetCockpitTimer">integer GetCockpitTimer ()</h3>
<p>Returns the current time in seconds on the cockpit timer.</p>

<h2 id="CategoryEarthquake">Earthquake</h2>
<p>These functions control the global earthquake effect.</p>

<h3 id="StartEarthquake">StartEarthquake ( number magnitude )</h3>
<p>Starts a global earthquake effect.</p>

<h3 id="UpdateEarthQuake">UpdateEarthQuake ( number magnitude )</h3>
<p>Changes the magnitude of an existing earthquake effect.</p>
<p>Important: note the inconsistent capitalization, which matches the internal C++ script utility functions.</p>

<h3 id="StopEarthquake">StopEarthquake ()</h3>
<p>Stops the global earthquake effect.</p>

<h2 id="CategoryPathType">Path Type</h2>
<p>These functions get and set the looping type of a path.</p>
<p>Looking up the path type number in the PathType table will convert it to a string. Looking up the path type string in the PathType table will convert it to a number.</p>
<ul>
    <li>0: one-way</li>
    <li>1: round-trip</li>
    <li>2: loop</li>
</ul>

<h3 id="SetPathType">SetPathType ( string path, integer type ) [2.0+]</h3>
<p>Changes the named path to the given path type.</p>

<h3 id="GetPathType">integer GetPathType ( string path ) [2.0+]</h3>
<p>Returns the type of the named path.</p>

<h3 id="SetPathOneWay">SetPathOneWay ( string path )</h3>
<p>Changes the named path to one-way. Once a unit reaches the end of the 
path, it will stop.</p>

<h3 id="SetPathRoundTrip">SetPathRoundTrip ( string path )</h3>
<p>Changes the named path to round-trip. Once a unit reaches the end of 
the path, it will follow the path backwards to the start and begin again.</p>

<h3 id="SetPathLoop">SetPathLoop ( string path )</h3>
<p>Changes the named path to looping. Once a unit reaches the end of the 
path, it will continue along to the start and begin again.</p>

<h2 id="CategoryPathPoints">Path Points [2.0+]</h2>

<h3 id="GetPathPointCount">integer GetPathPointCount( string path ) [2.0+]</h3>
<p>Returns the number of points in the named path, or 0 if the path does not exist.</p>

<h2 id="CategoryPathArea">Path Area [2.0+]</h2>
<p>These functions treat a path as the boundary of a closed polygonal area.</p>

<h3 id="GetWindingNumberForHandle">integer GetWindingNumber( string path, handle h ) [2.0+]</h3>
<p>Returns how many times the named path loops around the given game object.</p>
<p>Each full counterclockwise loop adds one and each full clockwise loop subtracts one.</p>

<h3 id="GetWindingNumberForVector">integer GetWindingNumber( string path, vector position ) [2.0+]</h3>
<p>Returns how many times the named path loops around the given position.</p>
<p>Each full counterclockwise loop adds one and each full clockwise loop subtracts one.</p>

<h3 id="GetWindingNumberForMatrix">integer GetWindingNumber( string path, matrix transform ) [2.0+]</h3>
<p>Returns how many times the named path loops around the position of the given transform.</p>
<p>Each full counterclockwise loop adds one and each full clockwise loop subtracts one.</p>

<h3 id="IsInsideAreaAtHandle">boolean IsInsideArea( string path, handle h ) [2.0+]</h3>
<p>Returns true if the given game object is inside the area bounded by the named path. Returns false otherwise.</p>
<p>This function is equivalent to </p><pre>GetWindingNumber( path, h ) ~= 0</pre><p></p>

<h3 id="IsInsideAreaAtVector">boolean IsInsideArea( string path, vector position ) [2.0+]</h3>
<p>Returns true if the given position is inside the area bounded by the named path. Returns false otherwise.</p>
<p>This function is equivalent to </p><pre>GetWindingNumber( path, position ) ~= 0</pre><p></p>

<h3 id="IsInsideAreaAtMatrix">boolean IsInsideArea( string path, matrix transform ) [2.0+]</h3>
<p>Returns true if the position of the given transform is inside the area bounded by the named path. Returns false otherwise.</p>
<p>This function is equivalent to </p><pre>GetWindingNumber( path, transform ) ~= 0</pre><p></p>

<h2 id="CategoryUnitCommands">Unit Commands</h2>
<p>These functions send commands to units or query their command state.</p>

<h3 id="AiCommand">AiCommand</h3>
<p>This is a global table that converts between command numbers and command names. For example, AiCommand.GO or AiCommand["GO"] returns the command number (3) for the "go" command; AiCommand[3] returns the command name ("GO") for command number 3. For maintainability, always use this table instead of raw command numbers.</p>
<p>Available commands: NONE, SELECT, STOP, GO, ATTACK, FOLLOW, FORMATION, PICKUP, DROPOFF, NO_DROPOFF, GET_REPAIR, GET_RELOAD, GET_WEAPON, GET_CAMERA, GET_BOMB, DEFEND, GO_TO_GEYSER, RESCUE, RECYCLE, SCAVENGE, HUNT, BUILD, PATROL, STAGE, SEND, GET_IN, LAY_MINES, CLOAK [2.1+], DECLOAK [2.1+].</p>

<h3 id="CanCommand">boolean CanCommand ( handle me )</h3>
<p>Returns true if the game object can be commanded. Returns false otherwise.</p>

<h3 id="CanBuild">boolean CanBuild ( handle me )</h3>
<p>Returns true if the game object is a producer that can build at the moment. Returns false otherwise.</p>

<h3 id="IsBusy">boolean IsBusy ( handle me )</h3>
<p>Returns true if the game object is a producer and currently busy. Returns false otherwise.</p>

<h3 id="GetCurrentCommand">integer GetCurrentCommand ( handle me )</h3>
<p>Returns the current command for the game object. Looking up the command number in the AiCommand table will convert it to a string. Looking up the command string in the AiCommand table will convert it back to a number.</p>

<h3 id="GetCurrentWho">handle GetCurrentWho ( handle me )</h3>
<p>Returns the target of the current command for the game object. Returns nil if it has none.</p>

<h3 id="GetIndependence">integer GetIndependence( handle me )</h3>
<p>Gets the independence of a unit.</p>

<h3 id="SetIndependence">SetIndependence ( handle me, integer independence)</h3>
<p>Sets the independence of a unit. 1 (the default) lets the unit take initiative (e.g. attack nearby enemies), while 0 prevents that.</p>

<h3 id="SetCommand">SetCommand ( handle me, integer command, [ integer priority ], [ handle who 
], [ matrix|vector|string where ], [ number when ], [ string param ] )</h3>
<p>Commands the unit using the given parameters. Be careful with this since not all commands work with all units and some have strict requirements on their parameters.</p>
<p>"Command" is the command to issue, normally chosen from the global AiCommand table (e.g. AiCommand.GO).</p>
<p>"Priority" is the command priority; a value of 0 leaves the unit commandable by the player while the default value of 1 makes it uncommandable.</p>
<p>"Who" is an optional target game object.</p>
<p>"Where" is an optional destination, and can be a matrix (transform), a vector (position), or a string (path name).</p>
<p>"When" is an optional absolute time value only used by command AiCommand.STAGE.</p>
<p>"Param" is an optional odf name only used by command AiCommand.BUILD.</p>

<h3 id="Attack">Attack ( handle me, handle him , [ integer priority ] )</h3>
<p>Commands the unit to attack the given target.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="GotoPath">Goto ( handle me, string path , [ integer priority ] )</h3>
<p>Commands the unit to go to the named path.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="GotoHandle">Goto ( handle me, handle him , [ integer priority ] )</h3>
<p>Commands the unit to go to the given target</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="GotoVector">Goto ( handle me, vector position , [ integer priority ] )</h3>
<p>Commands the unit to go to the given position vector</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="GotoMatrix">Goto ( handle me, matrix transform , [ integer priority ] )</h3>
<p>Commands the unit to go to the position of the given transform matrix</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="MinePath">Mine ( handle me, string path , [ integer priority ] )</h3>
<p>Commands the unit to lay mines at the named path; only minelayer units support this.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="MineVector">Mine ( handle me, vector position, [ integer priority ] )</h3>
<p>Commands the unit to lay mines at the given position vector</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="MineMatrix">Mine ( handle me, matrix transform, [ integer priority ] )</h3>
<p>Commands the unit to lay mines at the position of the transform matrix</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="Follow">Follow ( handle me, handle him, [ integer priority ] )</h3>
<p>Commands the unit to follow the given target.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="IsFollowing">boolean IsFollowing(handle me, handle him) [2.1+]</h3>
<p>Returns true if the unit is currently following the given target.</p>

<h3 id="Defend">Defend ( handle me, [ integer priority ] )</h3>
<p>Commands the unit to defend its current location.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="Defend2">Defend2 ( handle me, handle him, [ integer priority ] )</h3>
<p>Commands the unit to defend the given target.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="Stop">Stop ( handle me, [ integer priority ] )</h3>
<p>Commands the unit to stop at its current location.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="Patrol">Patrol ( handle me, string path, [ integer priority ] )</h3>
<p>Commands the unit to patrol along the named path. This is equivalent to Goto with an independence of 1.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="RetreatToPath">Retreat ( handle me, string path, [ integer priority ] )</h3>
<p>Commands the unit to retreat to the named path. This is equivalent to Goto with an independence of 0.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="RetreatToHandle">Retreat ( handle me, handle him , [ integer priority ] )</h3>
<p>Commands the unit to retreat to the given target. This is equivalent to Goto with an independence of 0.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="GetIn">GetIn ( handle me, handle him, [ integer priority ] )</h3>
<p>Commands the pilot to get into the target vehicle.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="Pickup">Pickup ( handle me, handle him, [ integer priority ] )</h3>
<p>Commands the unit to pick up the target object. Deployed units pack up (ignoring the target), scavengers pick up scrap, and tugs pick up and carry objects.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="DropoffAtPath">Dropoff ( handle me, string path, [ integer priority ] )</h3>
<p>Commands the unit to drop off at the named path. Tugs drop off their cargo and Construction Rigs build the selected item at the location using their current facing.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="DropoffAtVector">Dropoff ( handle me, vector position, [ integer priority ] )</h3>
<p>Commands the unit to drop off at the position vector. Tugs drop off their cargo and Construction Rigs build the selected item at the location using their current facing.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="DropoffAtMatrix">Dropoff ( handle me, matrix transform, [ integer priority ] )</h3>
<p>Commands the unit to drop off at the position of the transform matrix. Tugs drop off their cargo and Construction Rigs build the selected item with the facing of the transform matrix.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="Build">Build ( handle me, string odfname, [ integer priority ] )</h3>
<p>Commands a producer to build the given odf name. The Armory and Construction Rig need an additional Dropoff to give them a location to build but first need at least one simulation update to process the Build.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="BuildAtHandle">BuildAt ( handle me, string odfname, handle target, [ integer priority ] )</h3>
<p>Commands a producer to build the given odf name at the location of the target game object. A Construction Rig will build at the location and an Armory will launch the item to the location. Other producers will ignore the location.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="BuildAtPath">BuildAt ( handle me, string odfname, string path, [ integer priority ] )</h3>
<p>Commands a producer to build the given odf name at the named path. A Construction Rig will build at the location and an Armory will launch the item to the location. Other producers will ignore the location.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="BuildAtVector">BuildAt ( handle me, string odfname, vector position, [ integer priority ] )</h3>
<p>Commands a producer to build the given odf name at the position vector. A Construction Rig will build at the location with their current facing and an Armory will launch the item to the location. Other producers will ignore the location.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="BuildAtMatrix">BuildAt ( handle me, string odfname, matrix transform, [ integer priority ] )</h3>
<p>Commands a producer to build the given odf name at the transform matrix. A Construction Rig will build at the location with the facing of the transform and an Armory will launch the item to the location. Other producers will ignore the location.</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="Formation">Formation ( handle me, handle him, [ integer priority ] ) [2.1+]</h3>
<p>Commands the unit to follow the given target closely. This function is equivalent to SetCommand(me, AiCommand.FORMATION, priority, him).</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h3 id="Hunt">Hunt ( handle me, [ integer priority ] ) [2.1+]</h3>
<p>Commands the unit to hunt for targets autonomously. This function is equivalent to SetCommand(me, AiCommand.HUNT, priority).</p>
<p>Priority 0 leaves the unit commandable while the default priority 1 makes it uncommandable.</p>

<h2 id="CategoryTugCargo">Tug Cargo</h2>
<p>These functions query Tug and Cargo.</p>

<h3 id="HasCargo">boolean HasCargo ( handle tug )</h3>
<p>Returns true if the unit is a tug carrying cargo.</p>

<h3 id="GetCargo">handle GetCargo ( handle tug ) [2.1+]</h3>
<p>Returns the handle of the cargo if the unit is a tug carrying cargo. Returns nil otherwise.</p>

<h3 id="GetTug">handle GetTug ( handle cargo )</h3>
<p>Returns the handle of the tug carrying the object. Returns nil if not carried.</p>

<h2 id="CategoryPilotActions">Pilot Actions</h2>
<p>These functions control the pilot of a vehicle.</p>

<h3 id="EjectPilot">EjectPilot ( handle h )</h3>
<p>Commands the vehicle's pilot to eject.</p>

<h3 id="HopOut">HopOut ( handle h )</h3>
<p>Commands the vehicle's pilot to hop out.</p>

<h3 id="KillPilot">KillPilot ( handle h )</h3>
<p>Kills the vehicle's pilot as if sniped.</p>

<h3 id="RemovePilot">RemovePilot ( handle h )</h3>
<p>Removes the vehicle's pilot cleanly.</p>

<h3 id="HoppedOutOf">handle HoppedOutOf ( handle h )</h3>
<p>Returns the vehicle that the pilot most recently hopped out of.</p>

<h2 id="CategoryHealthValues">Health Values</h2>
<p>These functions get and set health values on a game object.</p>

<h3 id="GetHealth">number GetHealth ( handle h )</h3>
<p>Returns the fractional health of the game object between 0 and 1.</p>

<h3 id="GetCurHealth">number GetCurHealth ( handle h )</h3>
<p>Returns the current health value of the game object.</p>

<h3 id="GetMaxHealth">number GetMaxHealth ( handle h )</h3>
<p>Returns the maximum health value of the game object.</p>

<h3 id="SetCurHealth">SetCurHealth ( handle h, number health )</h3>
<p>Sets the current health of the game object.</p>

<h3 id="SetMaxHealth">SetMaxHealth ( handle h, number health )</h3>
<p>Sets the maximum health of the game object.</p>

<h3 id="AddHealth">AddHealth ( handle h, number health )</h3>
<p>Adds to the current health of the game object.</p>

<h3 id="GiveMaxHealth">GiveMaxHealth ( handle h ) [2.1+]</h3>
<p>Sets the unit's current health to maximum.</p>

<h2 id="CategoryAmmoValues">Ammo Values</h2>
<p>These functions get and set ammo values on a game object.</p>

<h3 id="GetAmmo">number GetAmmo ( handle h )</h3>
<p>Returns the fractional ammo of the game object between 0 and 1.</p>

<h3 id="GetCurAmmo">number GetCurAmmo ( handle h )</h3>
<p>Returns the current ammo value of the game object.</p>

<h3 id="GetMaxAmmo">number GetMaxAmmo ( handle h )</h3>
<p>Returns the maximum ammo value of the game object.</p>

<h3 id="SetCurAmmo">SetCurAmmo ( handle h, number ammo )</h3>
<p>Sets the current ammo of the game object.</p>

<h3 id="SetMaxAmmo">SetMaxAmmo ( handle h, number ammo )</h3>
<p>Sets the maximum ammo of the game object.</p>

<h3 id="AddAmmo">AddAmmo ( handle h, number ammo )</h3>
<p>Adds to the current ammo of the game object.</p>

<h3 id="GiveMaxAmmo">GiveMaxAmmo ( handle h ) [2.1+]</h3>
<p>Sets the unit's current ammo to maximum.</p>

<h2 id="CategoryCinematicCamera">Cinematic Camera</h2>
<p>These functions control the cinematic camera for in-engine cut scenes (or 
"cineractives" as the Interstate '76 team at Activision called them).</p>

<h3 id="CameraReady">boolean CameraReady ()</h3>
<p>Starts the cinematic camera and disables normal input.</p>
<p>Always returns true.</p>

<h3 id="CameraPath">boolean CameraPath ( string path, integer height, integer speed, handle target )</h3>
<p>Moves a cinematic camera along a path at a given height and speed while looking at a target game object.</p>
<p>Returns true when the camera arrives at its destination. Returns false otherwise.</p>

<h3 id="CameraPathDir">boolean CameraPathDir ( string path, integer height, integer speed )</h3>
<p>Moves a cinematic camera long a path at a given height and speed while looking along the path direction.</p>
<p>Returns true when the camera arrives at its destination. Returns false otherwise.</p>

<h3 id="PanDone">boolean PanDone ()</h3>
<p>Returns true when the camera arrives at its destination. Returns false otherwise.</p>

<h3 id="CameraObject">boolean CameraObject ( handle base, integer right, integer up, integer forward, handle target )</h3>
<p>Offsets a cinematic camera from a base game object while looking at a target game object. The right, up, and forward offsets are in centimeters.</p>
<p>Returns true if the base or handle game object does not exist. Returns false otherwise.</p>

<h3 id="CameraFinish">boolean CameraFinish ()</h3>
<p>Finishes the cinematic camera and enables normal input.</p>
<p>Always returns true.</p>

<h3 id="CameraCancelled">boolean CameraCancelled ()</h3>
<p>Returns true if the player canceled the cinematic. Returns false otherwise.</p>

<h2 id="CategoryInfoDisplay">Info Display</h2>

<h3 id="IsInfo">boolean IsInfo ( string odfname )</h3>
<p>Returns true if the game object inspected by the info display matches the given odf name.</p>

<h2 id="CategoryNetwork">Network</h2>
<p>LuaMission currently has limited network support, but can detect if the 
mission is being run in multiplayer and if the local machine is hosting.</p>

<h3 id="IsNetGame">boolean IsNetGame ()</h3>
<p>Returns true if the game is a network game. Returns false otherwise.</p>

<h3 id="IsHosting">boolean IsHosting ()</h3>
<p>Returns true if the local machine is hosting a network game. Returns false otherwise.</p>

<h3 id="SetLocal">SetLocal ( handle h )</h3>
<p>Sets the game object as local to the machine the script is running on, 
transferring ownership from its original owner if it was remote. Important 
safety tip: only call this on one machine at a time!</p>

<h3 id="IsLocal">boolean IsLocal ()</h3>
<p>Returns true if the game is local to the machine the script is running on. 
Returns false otherwise.</p>

<h3 id="IsRemote">boolean IsRemote ()</h3>
<p>Returns true if the game object is remote to the machine the script is 
running on. Returns false otherwise.</p>

<h3 id="DisplayMessage">DisplayMessage ( string message )</h3>
<p>Adds a system text message to the chat window on the local machine.</p>

<h3 id="Send">Send ( integer to, string type, ... )</h3>
<p>Send a script-defined message across the network.</p>
<p>To is the player network id of the recipient. None, nil, or 0 broadcasts to all players.</p>
<p>Type is a one-character string indicating the script-defined message type.</p>
<p>Other parameters will be sent as data and passed to the recipient's Receive function as parameters. Send supports nil, boolean, handle, integer, number, string, vector, and matrix data types. It does not support function, thread, or arbitrary userdata types.</p>
<p>The sent packet can contain up to 244 bytes of data (255 bytes maximum for an Anet packet minus 6 bytes for the packet header and 5 bytes for the reliable transmission header)</p>

<table>
<tbody><tr><th colspan="2">Type</th><th>Bytes</th></tr>
<tr><td colspan="2">nil</td><td>1</td></tr>
<tr><td colspan="2">boolean</td><td>1</td></tr>
<tr><td rowspan="2">handle</td><td>invalid (zero)</td><td>1</td></tr>
<tr><td>valid (nonzero)</td><td>1 + sizeof(int) = 5</td></tr>
<tr><td rowspan="5">number</td><td>zero</td><td>1</td></tr>
<tr><td>char (integer -128 to 127)</td><td>1 + sizeof(char) = 2</td></tr>
<tr><td>short (integer -32768 to 32767)</td><td>1 + sizeof(short) = 3</td></tr>
<tr><td>int (integer)</td><td>1 + sizeof(int) = 5</td></tr>
<tr><td>double (non-integer)</td><td>1 + sizeof(double) = 9</td></tr>
<tr><td rowspan="2">string</td><td>length &lt; 31</td><td>1 + length</td></tr>
<tr><td>length &gt;= 31</td><td>2 + length</td></tr>
<tr><td rowspan="2">table</td><td>count &lt; 31</td><td>1 + count + size of keys and values</td></tr>
<tr><td>count &gt;= 31</td><td>2 + count + size of keys and values</td></tr>
<tr><td rowspan="2">userdata</td><td>VECTOR_3D</td><td>1 + sizeof(VECTOR_3D) = 13</td></tr>
<tr><td>MAT_3D</td><td>1 + sizeof(REDUCED_MAT) = 12</td></tr>
</tbody></table>

<h2 id="CategoryReadODF">Read ODF</h2>
<p>These functions read values from an external ODF, INI, or TRN file.</p>

<h3 id="OpenODF">odfhandle OpenODF ( string filename )</h3>
<p>Opens the named file as an ODF. If the file name has no extension, the function will append ".odf" automatically.</p>
<p>If the file is not already open, the function reads in and parses the file 
into an internal database. If you need to read values from it relatively 
frequently, save the handle into a global variable to prevent it from closing.</p>
<p>Returns the file handle if it succeeded. Returns nil if it failed.</p>

<h3 id="GetODFBool">boolean, boolean GetODFBool ( odfhandle odf, [ string section ], string label, [ boolean default ] )</h3>
<p>Reads a boolean value from the named label in the named section of the ODF file. Use a nil section to read labels that aren't in a section.</p>
<p>It considers values starting with 'Y', 'y', 'T', 't', or '1' to be true and value starting with 'N', 'n', 'F', 'f', or '0' to be false. Other values are considered undefined.</p>
<p>If a value is not found or is undefined, it uses the default value. If no default value is given, the default value is false. </p>
<p>Returns the value and whether the value was found.</p>

<h3 id="GetODFInt">integer, boolean GetODFInt ( odfhandle odf, [ string section ], string label, [ integer default ] )</h3>
<p>Reads an integer value from the named label in the named section of the ODF file. Use nil as the section to read labels that aren't in a section. </p>
<p>If no value is found, it uses the default value. If no default value is given, the default value is 0. </p>
<p>Returns the value and whether the value was found.</p>

<h3 id="GetODFFloat">number, boolean GetODFFloat ( odfhandle odf, [ string section ], string label, [ number default ] )</h3>
<p>Reads a floating-point value from the named label in the named section of the ODF file. Use nil as the section to read labels that aren't in a section.</p>
<p>If no value is found, it uses the default value. If no default value is given, the default value is 0.0.</p>
<p>Returns the value and whether the value was found.</p>

<h3 id="GetODFString">string, boolean GetODFString ( odfhandle odf, [ string section ], string label, 
[ string default ] )</h3>
<p>Reads a string value from the named label in the named section of the ODF file. Use nil as the section to read labels that aren't in a section.</p>
<p>If a value is not found, it uses the default value. If no default value is given, the default value is nil.</p>
<p>Returns the value and whether the value was found.</p>

<h2 id="CategoryTerrain">Terrain</h2>
<p>These functions return height and normal from the terrain height field.</p>

<h3 id="GetTerrainHeightAndNormalAtHandle">number, vector GetTerrainHeightAndNormal ( handle h )</h3>
<p>Returns the terrain height and normal vector at the location of the game object.</p>

<h3 id="GetTerrainHeightAndNormalAtPath">number, vector GetTerrainHeightAndNormal ( string path [, integer point ] )</h3>
<p>Returns the terrain height and normal vector at a point on the named path. It uses the start of the path if no point is given.</p>

<h3 id="GetTerrainHeightAndNormalAtVector">number, vector GetTerrainHeightAndNormal ( vector position )</h3>
<p>Returns the terrain height and normal vector at the position vector.</p>

<h3 id="GetTerrainHeightAndNormalAtMatrix">number, vector GetTerrainHeightAndNormal ( matrix transform )</h3>
<p>Returns the terrain height and normal vector at the position of the transform matrix.</p>

<h2 id="CategoryFloor">Floor</h2>
<p>These functions return height and normal from the terrain height field and the upward-facing polygons of any entities marked as floor owners.</p>

<h3 id="GetFloorHeightAndNormalAtHandle">number, vector GetFloorHeightAndNormal ( handle h )</h3>
<p>Returns the floor height and normal vector at the location of the game object.</p>

<h3 id="GetTerrainHeightAndNormalAtPath">number, vector GetFloorHeightAndNormal ( string path [, integer point ] )</h3>
<p>Returns the floor height and normal vector at a point on the named path. It uses the start of the path if no point is given.</p>

<h3 id="GetTerrainHeightAndNormalAtVector">number, vector GetFloorHeightAndNormal ( vector position )</h3>
<p>Returns the floor height and normal vector at the position vector.</p>

<h3 id="GetTerrainHeightAndNormalAtMatrix">number, vector GetFloorHeightAndNormal ( matrix transform )</h3>
<p>Returns the floor height and normal vector at the position of the transform matrix.</p>

<h2 id="CategoryMap">Map</h2>

<h3 id="GetMissionFilename">string GetMissionFilename () [2.0+]</h3>
<p>Returns the name of the BZN file for the map. This can be used to generate an ODF name for mission settings.</p>

<h3 id="GetMapTRNFilename">string GetMapTRNFilename ()</h3>
<p>Returns the name of the TRN file for the map. This can be used with OpenODF() to read values from the TRN file.</p>

<h2 id="CategoryFiles">Files [2.0+]</h2>

<h3 id="UseItem">string UseItem( string filename ) [2.0+]</h3>
<p>Returns the contents of the named file as a string, or nil if the file could not be opened.</p>

<h2 id="CategoryEffects">Effects [2.0+]</h2>

<h3 id="ColorFade">ColorFade ( number ratio, number rate, integer r, integer g, integer b ) [2.0+]</h3>
<p>Starts a full screen color fade.</p>
<p>Ratio sets the opacity, with 0.0 transparent and 1.0 almost opaque</p>
<p>Rate sets how fast the opacity decreases over time.</p>
<p>R, G, and B set the color components and range from 0 to 255</p>

<h2 id="CategoryVector">Vector</h2>
<p>This is a custom userdata representing a position or direction. It has three number components: x, y, and z.</p>

<h3 id="SetVectory">vector SetVector ( [ number x ], [ number y ], [ number z ] )</h3>
<p>Returns a vector whose components have the given number values. If no value is given for a component, the default value is 0.0.</p>

<h3 id="DotProduct">number DotProduct ( vector a, vector a )</h3>
<p>Returns the <a href="http://en.wikipedia.org/wiki/Dot_product">dot product</a> between vectors a and b.</p>
<p>Equivalent to a.x * b.x + a.y * b.y + a.z * b.z.</p>

<h3 id="CrossProduct">vector CrossProduct ( vector a, vector b )</h3>
<p>Returns the <a href="http://en.wikipedia.org/wiki/Cross_product">cross product</a> between vectors a and b.</p>
<p>Equivalent to SetVector(a.y * b.z - a.z * b.y, a.z * b.x - a.x * b.z, a.x * b.y - a.y * b.x).</p>

<h3 id="Normalize">vector Normalize ( vector v )</h3>
<p>Returns the vector scaled to unit length.</p>
<p>Equivalent to SetVector(v.x * scale, v.y * scale, v.z * scale) where scale is 1.0f / sqrt(v.x<sup>2</sup> + v.y<sup>2</sup> + v.z<sup>2</sup>).</p>

<h3 id="Length">number Length ( vector v )</h3>
<p>Returns the length of the vector.</p>
<p>Equivalent to sqrt(v.x<sup>2</sup> + v.y<sup>2</sup> + v.z<sup>2</sup>).</p>

<h3 id="LengthSquared">number LengthSquared ( vector v )</h3>
<p>Returns the squared length of the vector.</p>
<p>Equivalent to v.x<sup>2</sup> + v.y<sup>2</sup> + v.z<sup>2</sup>.</p>

<h3 id="Distance2D">number Distance2D ( vector a, vector b )</h3>
<p>Returns the 2D distance between vectors a and b.</p>
<p>Equivalent to sqrt((b.x - a.x)<sup>2</sup> + (b.z - a.z)<sup>2</sup>).</p>

<h3 id="Distance2DSquared">number Distance2DSquared ( vector a, vector b )</h3>
<p>Returns the squared 2D distance of the vector.</p>
<p>Equivalent to (b.x - a.x)<sup>2</sup> + (b.z - a.z)<sup>2</sup>.</p>

<h3 id="Distance3D">number Distance3D ( vector a, vector b )</h3>
<p>Returns the 3D distance between vectors a and b.</p>
<p>Equivalent to sqrt((b.x - a.x)<sup>2</sup> + (b.y - a.y)<sup>2</sup> + (b.z - a.z)<sup>2</sup>).</p>

<h3 id="Distance3DSquared">number Distance3DSquared ( vector a, vector b )</h3>
<p>Returns the squared 3D distance of the vector.</p>
<p>Equivalent to (b.x - a.x)<sup>2</sup> + (b.y - a.y)<sup>2</sup> + (b.z - a.z)<sup>2</sup>.</p>

<h3 id="NegateVector">-vector</h3>
<p>Negate the vector.</p>
<p>Equivalent to SetVector(-vector.x, -vector.y, -vector.z).</p>

<h3 id="AddVectors">vector1 + vector2</h3>
<p>Add two vectors.</p>
<p>Equivalent to SetVector(vector1.x + vector2.x, vector1.y + vector2.y, vector1.z + vector2.z).</p>

<h3 id="SubtractVectors">vector1 - vector2</h3>
<p>Subtract two vectors.</p>
<p>Equivlent to SetVector(vector1.x - vector2.x, vector1.y - vector2.y, vector1.z - vector2.z).</p>

<h3 id="MultiplyNumberVector">number * vector</h3>
<p>Multiply a number by a vector.</p>
<p>Equivalent to SetVector( number * vector.x, number * vector.y, number * vector.z).</p>

<h3 id="MultiplyVectorNumber">vector * number</h3>
<p>Multiply a vector by a number.</p>
<p>Equivalent to SetVector(vector.x * number, vector.y * number, vector.z * number).</p>

<h3 id="MultiplyVectors">vector1 * vector2</h3>
<p>Multiply two vectors.</p>
<p>Equivlent to SetVector(vector1.x * vector2.x, vector1.y * vector2.y, vector1.z * vector2.z)</p>

<h3 id="DivideNumberVector">number / vector</h3>
<p>Divide a number by a vector.</p>
<p>Equivalent to SetVector( number / vector.x, number / vector.y, number / vector.z).</p>

<h3 id="DivideVectorNumber">vector / number</h3>
<p>Divide a vector by a number.</p>
<p>Equivalent to SetVector(vector.x / number, vector.y / number, vector.z / number).</p>

<h3 id="DivideVectors">vector1 / vector2</h3>
<p>Divide two vectors.</p>
<p>Equivlent to SetVector(vector1.x / vector2.x, vector1.y / vector2.y, vector1.z / vector2.z)</p>

<h3 id="EqualVectors">vector1 == vector2</h3>
<p>Check if two vectors are equal.</p>

<h3 id="UnequalVectors">vector1 ~= vector2</h3>
<p>Check if two vectors are not equal.</p>

<h2 id="CategoryMatrix">Matrix</h2>
<p>This is a custom userdata representing an orientation and position in space. It has four vector components (right, up, front, and posit) sharing space with twelve number components (right_x, right_y, right_z, up_x, up_y, up_z, front_x, front_y, front_z, posit_x, posit_y, posit_z).</p>

<h3 id="SetMatrix">matrix SetMatrix ( [ number right_x ], [ number right_y ], [ number right_z ], [ number up_x ], [ number up_y ], [ number up_z ], [ number front_x ], [ number front_y ], [ number front_z ], [ number posit_x ], [ number posit_y ], [ number posit_z ] )</h3>
<p>Returns a matrix whose components have the given number values. If no value is given for a component, the default value is zero. Be careful with this since it's easy to build a non-orthonormal matrix that will break all kinds of built-in assumptions.</p>

<h3 id="IdentityMatrix">matrix IdentityMatrix</h3>
<p>Global value representing the identity matrix.</p>
<p>Equivalent to SetMatrix(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0).</p>

<h3 id="BuildAxisRotationMatrixNumbers">matrix BuildAxisRotationMatrix ( [ number angle ], [ number axis_x ], [ number axis_y ], [ number axis_z ] )</h3>
<p>Build a matrix representing a rotation by an angle around an axis. The angle is in radians. If no value is given for the angle or an axis component, the default value is zero. The axis must be unit-length (i.e. axis_x<sup>2</sup> + axis_y<sup>2</sup> + axis_z<sup>2</sup> = 1.0 or the resulting matrix will be wrong.</p>

<h3 id="BuildAxisRotationMatrixVector">matrix BuildAxisRotationMatrix ( [ number angle ], vector axis )</h3>
<p>Build a matrix representing a rotation by an angle around an axis. The angle is in radians. If no value is given for the angle, the default value is zero. The axis must be unit-length (i.e. axis.x<sup>2</sup> + axis.y<sup>2</sup> + axis.z<sup>2</sup> = 1.0 or the resulting matrix will be wrong.</p>

<h3 id="BuildPositionRotationMatrixNumbers">matrix BuildPositionRotationMatrix ( [ number pitch ], [ number yaw ], [ number roll ], [ number posit_x ], [ number posit_y ], [ number posit_z ] )</h3>
<p>Build a matrix with the given pitch, yaw, and roll angles and position. The angles are in radians. If no value is given for a component, the default value is zero.</p>

<h3 id="BuildPositionRotationMatrixVector">matrix BuildPositionRotationMatrix ( [ number pitch ], [ number yaw ], [ number roll ], vector position )</h3>
<p>Build a matrix with the given pitch, yaw, and roll angles and position. The angles are in radians. If no value is given for a component, the default value is zero.</p>

<h3 id="BuildOrthogonalMatrix">matrix BuildOrthogonalMatrix ( [ vector up ], [ vector heading ] )</h3>
<p>Build a matrix with zero position, its up axis along the specified up vector, oriented so that its front axis points as close as possible to the heading vector. If up is not specified, the default value is the Y axis. If heading is not specified, the default value is the Z axis.</p>

<h3 id="BuildDirectionalMatrix">matrix BuildDirectionalMatrix ( [ vector position ], [ vector direction ] )</h3>
<p>Build a matrix with the given position vector, its front axis pointing along the direction vector, and zero roll. If position is not specified, the default value is a zero vector. If direction is not specified, the default value is the Z axis.</p>

<h3 id="MultiplyMatrices">matrix * matrix</h3>
<p>Multiply two matrices.</p>

<h3 id="TransformVector">matrix * vector</h3>
<p>Transform a vector by a matrix.</p>

<h2 id="CategoryPortalFunctions">Portal Functions [2.1+]</h2>
<p>These functions control the Portal building introduced in The Red Odyssey expansion.</p>

<h3 id="PortalOut">PortalOut ( handle portal ) [2.1+]</h3>
<p>Sets the specified Portal direction to "out", indicated by a blue visual effect while active.</p>

<h3 id="PortalIn">PortalIn ( handle portal ) [2.1+]</h3>
<p>Sets the specified Portal direction to "in", indicated by an orange visual effect while active.</p>

<h3 id="DeactivatePortal">DeactivatePortal ( handle portal ) [2.1+]</h3>
<p>Deactivates the specified Portal, stopping the visual effect.</p>

<h3 id="ActivatePortal">ActivatePortal ( handle portal ) [2.1+]</h3>
<p>Activates the specified Portal, starting the visual effect.</p>

<h3 id="IsIn">bool IsIn ( handle portal ) [2.1+]</h3>
<p>Returns true if the specified Portal direction is "in". Returns false otherwise.</p>

<h3 id="isPortalActive">bool isPortalActive ( handle portal ) [2.1+]</h3>
<p>Returns true if the specified Portal is active. Returns false otherwise.</p>
<p>Important: note the capitalization!</p>

<h3 id="BuildObjectAtPortal">handle BuildObjectAtPortal ( string odfname, integer teamnum, handle portal ) [2.1+]</h3>
<p>Creates a game object with the given odf name and team number at the location of a portal.</p>
<p>The object is created at the location of the visual effect and given a 50 m/s initial velocity.</p>

<h2 id="CategoryCloak">Cloak [2.1+]</h2>
<p>These functions control the cloaking state of craft capable of cloaking.</p>

<h3 id="Cloak">Cloak ( handle h ) [2.1+]</h3>
<p>Makes the specified unit cloak if it can.</p>
<p>Note: unlike SetCommand(h, AiCommand.CLOAK), this does not change the unit's current command.</p>

<h3 id="Decloak">Decloak ( handle h ) [2.1+]</h3>
<p>Makes the specified unit de-cloak if it can.</p>
<p>Note: unlike SetCommand(h, AiCommand.DECLOAK), this does not change the unit's current command.</p>

<h3 id="SetCloaked">SetCloaked ( handle h ) [2.1+]</h3>
<p>Instantly sets the unit as cloaked (with no fade out).</p>

<h3 id="SetDecloaked">SetDecloaked ( handle h ) [2.1+]</h3>
<p>Instant sets the unit as uncloaked (with no fade in).</p>

<h3 id="IsCloaked">bool IsCloaked ( handle h ) [2.1+]</h3>
<p>Returns true if the unit is cloaked. Returns false otherwise</p>

<h3 id="EnableCloaking">EnableCloaking ( handle h, bool enable ) [2.1+]</h3>
<p>Enable or disable cloaking for a specified cloaking-capable unit.</p>
<p>Note: this does not grant a non-cloaking-capable unit the ability to cloak.</p>

<h3 id="EnableAllCloaking">EnableAllCloaking ( bool enable ) [2.1+]</h3>
<p>Enable or disable cloaking for all cloaking-capable units.</p>
<p>Note: this does not grant a non-cloaking-capable unit the ability to cloak.</p>

<h2 id="CategoryHide">Hide [2.1+]</h2>
<p>These functions hide and show game objects. When hidden, the object is invisible (similar to Phantom VIR and cloak) and undetectable on radar (similar to RED Field and cloak). The effect is similar to but separate from cloaking. For the most part, AI units ignore the hidden state.</p>

<h3 id="Hide">void Hide( handle h ) [2.1+]</h3>
<p>Hides a game object.</p>

<h3 id="UnHide">void UnHide( handle h ) [2.1+]</h3>
<p>Un-hides a game object.</p>

<h2 id="CategoryExplosion">Explosion [2.1+]</h2>
<p>These functions create explosions at a specified location. They do not return a handle because explosions are not game objects and thus not visible to the scripting system.</p>

<h3 id="MakeExplosionAtHandle">MakeExplosion ( string odfname, handle h ) [2.1+]</h3>
<p>Creates an explosion with the given odf name at the location of a game object.</p>

<h3 id="MakeExplosionAtPath">MakeExplosion ( string odfname, string path ) [2.1+]</h3>
<p>Creates an explosion with the given odf name at the start of the named path.</p>

<h3 id="MakeExplosionAtVector">MakeExplosion ( string odfname, vector position ) [2.1+]</h3>
<p>Creates an explosion with the given odf name at the given position vector.</p>

<h3 id="MakeExplosionAtMatrix">MakeExplosion ( string odfname, matrix transform ) [2.1+]</h3>
<p>Creates an explosion with the given odf name with the given transform matrix.</p>


</body></html>